<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Escena A-Frame Realista</title>
  <!-- A-Frame (última 1.x estable adecuada) -->
<script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.2/dist/aframe-extras.min.js"></script>

    <style>
      html, body { height:100%; margin:0; background:#000; touch-action: none; -ms-touch-action: none; }
      a-scene { width:100%; height:100vh; display:block; }
    </style>
    
  </head>
  <body>
    <a-scene shadow="type: pcfsoft" 
             renderer="antialias: true; colorManagement: true; physicallyCorrectLights: true; toneMapping: ACESFilmic; exposure: 1.0">
      
      <!-- Assets: modelos GLB separados -->
      <a-assets>
        <a-asset-item id="pisoModel" src="models/piso.glb"></a-asset-item>
        <a-asset-item id="paredesModel" src="models/paredes.glb"></a-asset-item>
        <a-asset-item id="techoModel" src="models/techo.glb"></a-asset-item>
        <!-- Otros modelos de assets aquí -->
        <a-asset-item id="cuarto1" src="models/assets1.glb"></a-asset-item>
        <a-asset-item id="cuarto2" src="models/assets2.glb"></a-asset-item>
        <a-asset-item id="cuarto3" src="models/assets3.glb"></a-asset-item>
        <a-asset-item id="cuarto4" src="models/assets4.glb"></a-asset-item>
        <a-asset-item id="cuarto5" src="models/assets5.glb"></a-asset-item>
        <a-asset-item id="cuarto6" src="models/assets6.glb"></a-asset-item>
        <a-asset-item id="cuarto7" src="models/assets7.glb"></a-asset-item>

        <a-asset-item id="moustroModel" src="models/moustrocuarto.glb"></a-asset-item>

        <a-asset-item id="floorMesh" src="models/navmesh.glb"></a-asset-item>
      </a-assets>
      
<a-entity gltf-model="#floorMesh" nav-mesh visible="false"></a-entity>
      
      <!-- Luces: ambiental + direccional -->
<!-- Lámpara para móvil -->
<a-entity id="greenLamp-mobile"
    position="-1.5 1.5 0"
    visible="false"
    light="type: point;
           color: #a3ff78;
           intensity: 2;
           distance: 15;
           decay: 0;
           castShadow: false;
           shadowMapWidth: 150; 
           shadowMapHeight: 150; 
           shadowBias: -0.005; 
           shadowRadius: 0; 
           shadowCameraNear: 0.1; 
           shadowCameraFar: 15">
</a-entity>

  <!-- Lámpara para desktop -->
  <a-entity id="greenLamp-desktop"
    position="-1.5 1.5 -0.75"
    visible="false"
    light="type: point;
           color: #2bff7a;
           intensity: 5;
           distance: 30;
           decay: 2;
           castShadow: true;
           shadowMapWidth: 1920;
           shadowMapHeight: 1920;
           shadowBias: -0.0003;
           shadowRadius: 1;
           shadowCameraNear: 0.1;
           shadowCameraFar: 60">
  </a-entity>

      <!-- Modelos GLB cargados -->
      <a-entity gltf-model="#pisoModel" shadow="receive: true"></a-entity>
      <a-entity gltf-model="#paredesModel" shadow="cast: true; receive: true"></a-entity>
      <a-entity gltf-model="#techoModel" shadow="cast: true"></a-entity>
      <!-- otros modelos y entidades aquí -->
      <a-entity id="cuarto1_ent" gltf-model="#cuarto1" shadow="cast: true; receive: true"></a-entity>
      <a-entity id="cuarto2_ent" gltf-model="#cuarto2" shadow="cast: true; receive: true"></a-entity>
      <a-entity id="cuarto3_ent" gltf-model="#cuarto3" shadow="cast: true; receive: true"></a-entity>
      <a-entity id="cuarto4_ent" gltf-model="#cuarto4" shadow="cast: true; receive: true"></a-entity>
      <a-entity id="cuarto5_ent" gltf-model="#cuarto5" shadow="cast: true; receive: true"></a-entity>
      <a-entity id="cuarto6_ent" gltf-model="#cuarto6" shadow="cast: true; receive: true"></a-entity>
      <a-entity id="cuarto7_ent" gltf-model="#cuarto7" shadow="cast: true; receive: true"></a-entity>

      <a-entity gltf-model="#moustroModel"
          position="1.5 1.1 -0.5"
          scale="0.1 0.1 0.1"
          rotation="0 -90 0"
          shadow="cast: true; receive: true"
          animation-mixer="clip: *; loop: repeat; timeScale: 1">
      </a-entity>

      <!-- Cámara y controles -->
<a-entity id="rig"
  movement-controls="constrainToNavMesh: true;
                     controls: keyboard, nipple; speed: 0.06; acceleration: 20;"
  position="0 0 0">
  <a-entity camera position="0 1.5 0" look-controls></a-entity>
</a-entity>

      </a-scene>

    <script>
  // Detecta si es móvil o escritorio
  const isMobile = AFRAME.utils.device.isMobile();
  
  if (isMobile) {
    document.querySelector("#greenLamp-mobile").setAttribute("visible", "true");
  } else {
    document.querySelector("#greenLamp-desktop").setAttribute("visible", "true");
  }
</script>
    
  </body>
</html>
